!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.VueAutosuggest={})}(this,function(e){"use strict";var t={name:"default-section",props:{section:{type:Object,required:!0},currentIndex:{type:Number,required:!1,default:1/0},updateCurrentIndex:{type:Function,required:!0},searchInput:{type:String,required:!1,default:""},renderSuggestion:{type:Function,required:!0},normalizeItemFunction:{type:Function,required:!0}},computed:{list:function(){var e=this.section,t=e.limit,n=e.data;return n.length<t&&(t=n.length),n.slice(0,t)},className:function(){return"autosuggest__results_title autosuggest__results_title_"+this.section.name}},methods:{getItemIndex:function(e){return this.section.start_index+e},getItemByIndex:function(e){return this.section.data[e]},getLabelByIndex:function(e){return this.section.data[e]},onMouseEnter:function(e){this.updateCurrentIndex(e.currentTarget.getAttribute("data-suggestion-index"))},onMouseLeave:function(){this.updateCurrentIndex(null)}},render:function(e){var t=this,n=this.section.label?e("li",{class:this.className},this.section.label):"";return e("ul",{attrs:{role:"listbox","aria-labelledby":"autosuggest"}},[n,this.list.map(function(n,i){var s=t.normalizeItemFunction(t.section.name,t.section.type,t.getLabelByIndex(i),n);return e("li",{attrs:{role:"option","data-suggestion-index":t.getItemIndex(i),"data-section-name":t.section.name,id:"autosuggest__results_item-"+t.getItemIndex(i)},key:t.getItemIndex(i),class:{"autosuggest__results_item-highlighted":t.getItemIndex(i)==t.currentIndex,autosuggest__results_item:!0},on:{mouseenter:t.onMouseEnter,mouseleave:t.onMouseLeave}},[t.renderSuggestion(s)])})])}};function n(e,t){(function(e,t){return!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))})(e,t)||(e.className+=" "+t)}var i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:e.component_attr_id_autosuggest}},[n("input",e._g(e._b({directives:[{name:"model",rawName:"v-model",value:e.searchInput,expression:"searchInput"}],staticClass:"form-control",class:[e.isOpen?"autosuggest__input-open":"",e.inputProps.class],attrs:{type:"text",autocomplete:e.inputProps.autocomplete,role:"combobox","aria-autocomplete":"list","aria-owns":"autosuggest__results","aria-activedescendant":e.isOpen&&null!==e.currentIndex?"autosuggest__results_item-"+e.currentIndex:"","aria-haspopup":e.isOpen?"true":"false","aria-expanded":e.isOpen?"true":"false"},domProps:{value:e.searchInput},on:{keydown:e.handleKeyStroke,input:function(t){t.target.composing||(e.searchInput=t.target.value)}}},"input",e.inputProps,!1),e.listeners)),e._v(" "),n("div",{class:e.component_attr_class_autosuggest__results_container},[e.getSize()>0&&!e.loading?n("div",{class:e.component_attr_class_autosuggest__results,attrs:{"aria-labelledby":e.component_attr_id_autosuggest}},e._l(this.computedSections,function(t,i){return n(t.type,{key:e.getSectionRef(i),ref:e.getSectionRef(i),refInFor:!0,tag:"component",attrs:{normalizeItemFunction:e.normalizeItem,renderSuggestion:e.renderSuggestion,section:t,updateCurrentIndex:e.updateCurrentIndex,searchInput:e.searchInput}})})):e._e()])])},staticRenderFns:[],name:"autosuggest",components:{DefaultSection:t},props:{inputProps:{type:Object,required:!0,default:function(){return{id:{type:String,default:"autosuggest__input"},onInputChange:{type:Function,required:!0},initialValue:{type:String,required:!1},onClick:{type:Function,required:!1}}}},limit:{type:Number,required:!1,default:1/0},suggestions:{type:Array,required:!0,default:[]},renderSuggestion:{type:Function,required:!1,default:function(e){return e.item}},getSuggestionValue:{type:Function,required:!1,default:function(e){var t=e.item;return"object"==typeof t&&t.hasOwnProperty("name")?t.name:t}},shouldRenderSuggestions:{type:Function,required:!1,default:function(){return!0}},sectionConfigs:{type:Object,required:!1,default:function(){return{default:{onSelected:null}}}},onSelected:{type:Function,required:!1,default:null}},data:function(){return{component_attr_id_autosuggest:"autosuggest",component_attr_class_autosuggest__results_container:"autosuggest__results-container",component_attr_class_autosuggest__results:"autosuggest__results",searchInput:"",searchInputOriginal:null,currentIndex:null,currentItem:null,loading:!1,didSelectFromOptions:!1,computedSections:[],computedSize:0,internal_inputProps:{},defaultInputProps:{name:"q",initialValue:"",autocomplete:"off"},defaultSectionConfig:{name:"default",type:"default-section"}}},computed:{listeners:function(){var e=this;return Object.assign({},this.$listeners,{focus:function(t){e.$listeners.focus&&e.$listeners.focus(t),e.inputProps.onFocus&&e.onFocus(t)},blur:function(t){e.$listeners.blur&&e.$listeners.blur(t),e.inputProps.onBlur&&e.onBlur(t)},click:function(){e.loading=!1,e.$listeners.click&&e.$listeners.click(e.currentItem),e.inputProps.onClick&&e.onClick(e.currentItem),e.$nextTick(function(){e.ensureItemVisible(e.currentItem,e.currentIndex)})}})},isOpen:function(){return this.getSize()>0&&this.shouldRenderSuggestions()&&!this.loading}},methods:{_onSelected:function(){this.currentItem&&this.sectionConfigs[this.currentItem.name]&&this.sectionConfigs[this.currentItem.name].onSelected?this.sectionConfigs[this.currentItem.name].onSelected(this.currentItem,this.searchInputOriginal):this.sectionConfigs.default.onSelected?this.sectionConfigs.default.onSelected(null,this.searchInputOriginal):this.onSelected&&this.onSelected(this.currentItem)},getSectionRef:function(e){return"computed_section_"+e},getSize:function(){return this.computedSize},getItemByIndex:function(e){var t=!1;if(null===e)return t;for(var n=0;n<this.computedSections.length;n++)if(e>=this.computedSections[n].start_index&&e<=this.computedSections[n].end_index){var i=e-this.computedSections[n].start_index,s=this.$refs["computed_section_"+n][0];if(s){t=this.normalizeItem(this.computedSections[n].name,this.computedSections[n].type,s.getLabelByIndex(i),s.getItemByIndex(i));break}}return t},handleKeyStroke:function(e){var t=this,n=e.keyCode;if(!([16,9,18,91,93].indexOf(n)>-1))switch(this.loading=!1,this.didSelectFromOptions=!1,n){case 40:case 38:if(e.preventDefault(),this.isOpen){if(38===n&&null===this.currentIndex)break;var i=40===n?1:-1,s=parseInt(this.currentIndex)+i;this.setCurrentIndex(s,this.getSize(),i),this.didSelectFromOptions=!0,this.getSize()>0&&this.currentIndex>=0?(this.setChangeItem(this.getItemByIndex(this.currentIndex)),this.didSelectFromOptions=!0):-1==this.currentIndex&&(this.currentIndex=null,this.searchInput=this.searchInputOriginal,e.preventDefault())}break;case 13:if(e.preventDefault(),229===n)break;this.$nextTick(function(){t.getSize()>0&&t.currentIndex>=0&&(t.setChangeItem(t.getItemByIndex(t.currentIndex),!0),t.didSelectFromOptions=!0),t.loading=!0,t.$nextTick(function(){t._onSelected(t.didSelectFromOptions)})});break;case 27:this.isOpen&&(this.loading=!0,this.currentIndex=null,this.searchInput=this.searchInputOriginal,e.preventDefault())}},setChangeItem:function(e,t){void 0===t&&(t=!1),null===this.currentIndex?this.currentItem=null:e&&(this.searchInput=this.getSuggestionValue(e),this.currentItem=e,t&&(this.searchInputOriginal=this.getSuggestionValue(e)),this.ensureItemVisible(e,this.currentIndex))},normalizeItem:function(e,t,n,i){return{name:e,type:t,label:n,item:i}},ensureItemVisible:function(e,t){var n=document.querySelector("."+this.component_attr_class_autosuggest__results);if(e&&(t||0===t)&&n){var i=document.querySelector("#autosuggest__results_item-"+t);if(i){var s=n.clientHeight,u=n.scrollTop,r=i.clientHeight,o=i.offsetTop;r+o>=u+s?n.scrollTo(0,r+o-s):o<u&&u>0&&n.scrollTo(0,o)}}},updateCurrentIndex:function(e){this.currentIndex=e},onDocumentMouseUp:function(e){var t=this;null!==this.currentIndex&&this.isOpen?this.$el.contains(e.target)&&"INPUT"===e.target.tagName||(this.loading=!0,this.didSelectFromOptions=!0,this.setChangeItem(this.getItemByIndex(this.currentIndex),!0),this.$nextTick(function(){t._onSelected(!0)})):this.loading=this.shouldRenderSuggestions()},setCurrentIndex:function(e,t,i){void 0===t&&(t=-1);var s=e;null===this.currentIndex&&(s=0),this.currentIndex<0&&1===i&&(s=0),e>=t&&(s=0),this.currentIndex=s;var u,r,o=document.getElementById("autosuggest__results_item-"+this.currentIndex),a="autosuggest__results_item-highlighted";document.querySelector("."+a)&&(u=document.querySelector("."+a),r=a,u.classList&&u.classList.remove(r)),o&&n(o,a)},onClick:function(e){console.warn('inputProps.onClick is deprecated. Please use native click event listener \n\ne.g. <vue-autosuggest ... @click="clickMethod" /> \n\nhttps://vuejs.org/v2/guide/syntax.html#v-on-Shorthand'),this.internal_inputProps.onClick&&this.internal_inputProps.onClick(e)},onBlur:function(e){console.warn('inputProps.onBlur is deprecated. Please use native blur event listener \n\ne.g. <vue-autosuggest ... @blur="blurMethod" /> \n\nhttps://vuejs.org/v2/guide/syntax.html#v-on-Shorthand'),this.internal_inputProps.onBlur&&this.internal_inputProps.onBlur(e)},onFocus:function(e){console.warn('inputProps.onFocus is deprecated. Please use native focus event listener \n\ne.g. <vue-autosuggest ... @focus="focusMethod" /> \n\nhttps://vuejs.org/v2/guide/syntax.html#v-on-Shorthand'),this.internal_inputProps.onFocus&&this.internal_inputProps.onFocus(e)}},created:function(){this.internal_inputProps=Object.assign({},this.defaultInputProps,this.inputProps),this.inputProps.autocomplete=this.internal_inputProps.autocomplete,this.inputProps.name=this.internal_inputProps.name,this.searchInput=this.internal_inputProps.initialValue},mounted:function(){document.addEventListener("mouseup",this.onDocumentMouseUp),this.loading=!0},watch:{searchInput:function(e,t){this.value=e,this.didSelectFromOptions||(this.searchInputOriginal=this.value,this.currentIndex=null,this.internal_inputProps.onInputChange(e,t))},suggestions:{immediate:!0,handler:function(){var e=this;this.computedSections=[],this.computedSize=0,this.suggestions.forEach(function(t){if(t.data){var n=t.name?t.name:e.defaultSectionConfig.name,i=e.sectionConfigs[n],s=i.type,u=i.limit,r=i.label;s=s||e.defaultSectionConfig.type,u=u||1/0,u=t.data.length<u?t.data.length:u;var o={name:n,label:r=r||t.label,type:s,limit:u,data:t.data,start_index:e.computedSize,end_index:e.computedSize+u-1};e.computedSections.push(o),e.computedSize+=u}},this)}}}},s={install:function(e){e.component("vue-autosuggest-default-section",t),e.component("vue-autosuggest",i)}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(s),e.default=s,e.VueAutosuggest=i,e.DefaultSection=t,Object.defineProperty(e,"__esModule",{value:!0})});